---
phase: 10-more-controls
plan: 03
type: execute
wave: 3
depends_on: ["10-02"]
files_modified:
  - src/main/resources/com/dwc/laf/token-mapping.properties
  - src/main/java/com/dwc/laf/DwcLookAndFeel.java
  - src/main/java/com/dwc/laf/ui/DwcTableUI.java
  - src/main/java/com/dwc/laf/ui/DwcTableCellRenderer.java
  - src/main/java/com/dwc/laf/ui/DwcTableHeaderRenderer.java
  - src/test/java/com/dwc/laf/ui/DwcTableUITest.java
autonomous: true

must_haves:
  truths:
    - "JTable displays with alternating row striping (even/odd row colors)"
    - "JTable selected rows show primary-colored highlight with contrasting text"
    - "JTable header renders with styled bottom separator and themed text"
    - "JTable has no visible grid lines (modern clean look)"
  artifacts:
    - path: "src/main/java/com/dwc/laf/ui/DwcTableUI.java"
      provides: "JTable UI delegate that disables grid lines and installs renderers"
      exports: ["createUI"]
    - path: "src/main/java/com/dwc/laf/ui/DwcTableCellRenderer.java"
      provides: "Cell renderer with row striping and selection highlighting"
      exports: ["getTableCellRendererComponent"]
    - path: "src/main/java/com/dwc/laf/ui/DwcTableHeaderRenderer.java"
      provides: "Header cell renderer with bottom separator painting"
      exports: ["getTableCellRendererComponent"]
  key_links:
    - from: "DwcLookAndFeel.java"
      to: "DwcTableUI"
      via: "initClassDefaults TableUI registration"
      pattern: 'table.put\("TableUI"'
    - from: "DwcTableUI.java"
      to: "DwcTableCellRenderer"
      via: "installDefaults sets default renderer"
      pattern: "DwcTableCellRenderer"
    - from: "DwcTableUI.java"
      to: "DwcTableHeaderRenderer"
      via: "installDefaults sets header renderer"
      pattern: "DwcTableHeaderRenderer"
    - from: "DwcTableCellRenderer.java"
      to: "UIManager"
      via: "Reads alternateRowColor and selectionBackground from UIDefaults"
      pattern: "Table.alternateRowColor"
---

<objective>
Implement JTable UI delegate with row striping, selection highlighting, and styled header -- the most complex component in Phase 10.

Purpose: JTable is the most data-rich Swing component. Row striping, selection colors, and clean headers are critical for the DWC look. Uses renderer-based approach (not monolithic paint override) for maintainability per research recommendation.

Output: DwcTableUI with custom cell renderer (row striping + selection) and header renderer (styled separator), registered in DwcLookAndFeel.
</objective>

<execution_context>
@/Users/beff/.claude/get-shit-done/workflows/execute-plan.md
@/Users/beff/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-more-controls/10-RESEARCH.md
@.planning/phases/10-more-controls/10-01-SUMMARY.md
@.planning/phases/10-more-controls/10-02-SUMMARY.md
@src/main/java/com/dwc/laf/DwcLookAndFeel.java
@src/main/java/com/dwc/laf/painting/PaintUtils.java
@src/main/resources/com/dwc/laf/token-mapping.properties
@src/test/java/com/dwc/laf/ui/DwcButtonUITest.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Token mappings, DwcTableCellRenderer, and DwcTableHeaderRenderer</name>
  <files>
    src/main/resources/com/dwc/laf/token-mapping.properties
    src/main/java/com/dwc/laf/ui/DwcTableCellRenderer.java
    src/main/java/com/dwc/laf/ui/DwcTableHeaderRenderer.java
  </files>
  <action>
    1. **Token mappings** in `token-mapping.properties`:
       - Append to `--dwc-surface-3` line: `, color:Table.alternateRowColor` (surface-3 gives a subtle alternate color; if too dark, research also suggests `--dwc-surface-2` but surface-3 matches existing panel background and is a reasonable starting point -- will be visually verified in plan 04)
       - Append to `--dwc-color-primary` line: `, color:Table.selectionBackground`
       - Append to `--dwc-color-on-primary-text` line: `, color:Table.selectionForeground`
       - Append to `--dwc-color-default-dark` line: `, color:TableHeader.bottomSeparatorColor`
       - Append to `--dwc-color-body-text` line: `, color:Table.foreground, color:TableHeader.foreground`
       - The `--dwc-color-white` line already has `color:Table.background` -- confirm it is there

    2. **DwcTableCellRenderer.java** -- extending DefaultTableCellRenderer:
       - Override `getTableCellRendererComponent(JTable table, Object value, boolean isSelected, boolean hasFocus, int row, int column)`:
         - Call `super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column)`
         - If isSelected:
           - `setBackground(UIManager.getColor("Table.selectionBackground"))`
           - `setForeground(UIManager.getColor("Table.selectionForeground"))`
         - Else (not selected):
           - `Color bg = (row % 2 == 0) ? UIManager.getColor("Table.background") : UIManager.getColor("Table.alternateRowColor")`
           - `setBackground(bg != null ? bg : table.getBackground())`
           - `setForeground(table.getForeground())`
         - Remove focus border for cleaner look: `setBorder(BorderFactory.createEmptyBorder(2, 6, 2, 6))`
         - Return `this`

    3. **DwcTableHeaderRenderer.java** -- extending DefaultTableCellRenderer:
       - Override `getTableCellRendererComponent(...)`:
         - Call `super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column)`
         - `setForeground(UIManager.getColor("TableHeader.foreground"))` -- fallback to table foreground
         - `setFont(table.getFont().deriveFont(Font.BOLD))` -- bold header text
         - `setHorizontalAlignment(SwingConstants.LEADING)`
         - Set border: `setBorder(BorderFactory.createCompoundBorder(BorderFactory.createMatteBorder(0, 0, 1, 0, separatorColor), BorderFactory.createEmptyBorder(4, 6, 4, 6)))` where separatorColor = `UIManager.getColor("TableHeader.bottomSeparatorColor")` with `Color.GRAY` fallback
         - `setBackground(UIManager.getColor("control"))` -- match control surface
         - Return `this`
  </action>
  <verify>
    Files compile: `cd /Users/beff/_lab/dwclaf && mvn compile -q`
  </verify>
  <done>
    DwcTableCellRenderer provides row striping (even=background, odd=alternateRowColor) with selection priority. DwcTableHeaderRenderer provides bold text with bottom separator line. Both use UIManager colors for theme compatibility.
  </done>
</task>

<task type="auto">
  <name>Task 2: DwcTableUI delegate, L&F registration, and tests</name>
  <files>
    src/main/java/com/dwc/laf/DwcLookAndFeel.java
    src/main/java/com/dwc/laf/ui/DwcTableUI.java
    src/test/java/com/dwc/laf/ui/DwcTableUITest.java
  </files>
  <action>
    1. **DwcTableUI.java** -- extending BasicTableUI:
       - `public static ComponentUI createUI(JComponent c)` returning `new DwcTableUI()`
       - `installDefaults()`:
         - Call `super.installDefaults()`
         - Disable grid lines: `table.setShowGrid(false)`, `table.setIntercellSpacing(new Dimension(0, 0))` -- `table` is a protected field from BasicTableUI
         - Set row height: `table.setRowHeight(Math.max(table.getRowHeight(), 24))` -- minimum 24px rows
         - `table.setFillsViewportHeight(true)` -- fills viewport even with few rows (important per research pitfall 1)
         - Install default cell renderer: `table.setDefaultRenderer(Object.class, new DwcTableCellRenderer())`
         - Install header renderer: `if (table.getTableHeader() != null) { table.getTableHeader().setDefaultRenderer(new DwcTableHeaderRenderer()); }`
         - Set selection mode defaults: `table.setSelectionBackground(UIManager.getColor("Table.selectionBackground"))`, `table.setSelectionForeground(UIManager.getColor("Table.selectionForeground"))`
       - `uninstallDefaults()`:
         - Call `super.uninstallDefaults()`
       - No paint() override needed -- renderers handle all visual customization

    2. **DwcLookAndFeel.java** changes:
       - In `initClassDefaults()`: add `table.put("TableUI", "com.dwc.laf.ui.DwcTableUI")`
       - In `initComponentDefaults()`: add call to `initTableDefaults(table)`
       - Create `private void initTableDefaults(UIDefaults table)`:
         - Inherit alternate row color from surface-3 if not already set:
           - `if (table.getColor("Table.alternateRowColor") == null)` then set from `table.getColor("Panel.background")` -- fallback
         - `table.put("Table.scrollPaneBorder", new BorderUIResource(BorderFactory.createEmptyBorder()))` -- no scroll pane border
         - `table.put("Table.focusCellHighlightBorder", BorderFactory.createEmptyBorder(2, 6, 2, 6))` -- match renderer border
         - Log

    3. **DwcTableUITest.java**:
       - Save/restore L&F
       - `testUIInstalled()`: create JTable with sample data, assert `getUI() instanceof DwcTableUI`
       - `testPerComponentInstance()`: two tables have different UI instances
       - `testGridDisabled()`: `assertFalse(table.getShowHorizontalLines())`, `assertFalse(table.getShowVerticalLines())`
       - `testIntercellSpacingZero()`: `assertEquals(new Dimension(0, 0), table.getIntercellSpacing())`
       - `testRowHeightMinimum()`: `assertTrue(table.getRowHeight() >= 24)`
       - `testFillsViewportHeight()`: `assertTrue(table.getFillsViewportHeight())`
       - `testDefaultRendererInstalled()`: `assertInstanceOf(DwcTableCellRenderer.class, table.getDefaultRenderer(Object.class))`
       - `testHeaderRendererInstalled()`: `assertInstanceOf(DwcTableHeaderRenderer.class, table.getTableHeader().getDefaultRenderer())`
       - `testAlternateRowColorExists()`: `assertNotNull(UIManager.getColor("Table.alternateRowColor"))`
       - `testPaintNoError()`: create JTable with 5 rows x 3 cols sample data, setSize, paint to BufferedImage
       - `testPaintWithSelectionNoError()`: select row 0, paint to BufferedImage
       - Helper method: `createSampleTable()` returning a JTable with `new Object[][] {{"A","B","C"}, {"D","E","F"}, ...}` and column names
  </action>
  <verify>
    `cd /Users/beff/_lab/dwclaf && mvn test -pl . -Dtest="DwcTableUITest" -q` passes all tests.
    `cd /Users/beff/_lab/dwclaf && mvn test -q` -- full suite still passes.
  </verify>
  <done>
    JTable uses DwcTableUI with disabled grid lines, alternating row stripes, primary-colored selection, bold header with bottom separator, and 24px minimum row height. Eleven tests pass. Full test suite green.
  </done>
</task>

</tasks>

<verification>
- `mvn test -q` passes all tests (all prior plans + table tests)
- `grep "TableUI" src/main/java/com/dwc/laf/DwcLookAndFeel.java` shows registration
- JTable renders with no grid lines, row striping, selection highlighting, and styled header
</verification>

<success_criteria>
- DwcTableUI installed with disabled grid lines and custom renderers
- DwcTableCellRenderer provides row striping with selection priority
- DwcTableHeaderRenderer provides bold text with bottom separator
- All new tests pass, all existing tests pass
- Table registered in DwcLookAndFeel.initClassDefaults()
</success_criteria>

<output>
After completion, create `.planning/phases/10-more-controls/10-03-SUMMARY.md`
</output>
